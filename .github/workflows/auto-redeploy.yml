name: Scheduled Auto-Redeploy

on:
  schedule:
    - cron: '0 */4 * * *' # Runs every 4 hours at minute 0
  workflow_dispatch: # Allows manual triggering from GitHub Actions tab

permissions:
  contents: read

jobs:
  trigger-deploy:
    runs-on: ubuntu-latest
    steps:
      - name: Trigger Render Deploy Hook
        if: ${{ secrets.RENDER_DEPLOY_HOOK }}
        run: |
          curl -X POST "${{ secrets.RENDER_DEPLOY_HOOK }}"
          echo "Triggered deploy hook successfully."

      - name: Check for Secret
        if: ${{ !secrets.RENDER_DEPLOY_HOOK }}
        run: |
          echo "::error::Secret RENDER_DEPLOY_HOOK is missing! Please add it in GitHub Repository Settings > Secrets and variables > Actions."
          exit 1
